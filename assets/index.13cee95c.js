import{a as r,W as J,K as o,M as x,j as s}from"./loginSlice.25a195ef.js";import{d as U}from"./AccountBalance.e6148968.js";import{r as L,i as V,a as K,u as X,B as y,T as d,d as N,b as P,D as Q,e as W,f as Y}from"./App.ddda7292.js";import{M as Z}from"./Meta.9a639706.js";import{q as ee}from"./constants.70367cb1.js";import{m as te}from"./map.839e9770.js";import{D as ae}from"./DialogActions.e2fb042f.js";import{R as se,F as oe,a as re}from"./RadioGroup.3fa6d41c.js";import"./index.2ad62d4f.js";import"./index.module.51bb9f99.js";import"./useFormControl.732e4c2f.js";var I={},ne=V.exports;Object.defineProperty(I,"__esModule",{value:!0});var D=I.default=void 0,ce=ne(L()),ie=K,le=(0,ce.default)((0,ie.jsx)("path",{d:"M13.66 7c-.56-1.18-1.76-2-3.16-2H6V3h12v2h-3.26c.48.58.84 1.26 1.05 2H18v2h-2.02c-.25 2.8-2.61 5-5.48 5h-.73l6.73 7h-2.77L7 14v-2h3.5c1.76 0 3.22-1.3 3.46-3H6V7h7.66z"}),"CurrencyRupee");D=I.default=le;const pe="https://firebasestorage.googleapis.com/v0/b/flickmatch-374a2.appspot.com/o/fm_rainbow.png?alt=media&token=1b06ae27-bf10-4974-9100-6bb5f2308314",de="_logo_15ltc_11",me="_heading_15ltc_16",ue="_pageContainer_15ltc_21",he="_container_15ltc_27",fe="_passCard_15ltc_37",ye="_portraitPassCard_15ltc_38",_e="_ribbon_15ltc_56",ge="_title_15ltc_105",be="_subtitle_15ltc_114",Ne="_price_15ltc_119",Pe="_currency_15ltc_127",Ce="_status_15ltc_133",Ie="_pulse_15ltc_1",Se="_portraitDetails_15ltc_149",ve="_details_15ltc_158",Te="_sportsIcon_15ltc_185",we="_buyNow_15ltc_200",xe="_footballIcon_15ltc_225",De="_diaglogBox_15ltc_231",ke="_fieldTitle_15ltc_237",Re="_fieldTitleIcon_15ltc_243",je="_sectionFirst_15ltc_250",Oe="_cancel_15ltc_254",qe="_pay_15ltc_255",a={logo:de,heading:me,pageContainer:ue,container:he,passCard:fe,portraitPassCard:ye,ribbon:_e,title:ge,subtitle:be,price:Ne,currency:Pe,status:Ce,pulse:Ie,portraitDetails:Se,details:ve,sportsIcon:Te,buyNow:we,footballIcon:xe,diaglogBox:De,fieldTitle:ke,fieldTitleIcon:Re,sectionFirst:je,cancel:Oe,pay:qe},ze=(n,i,m,l,u)=>fetch("https://service.flickmatch.in/platform-0.0.1-SNAPSHOT/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`mutation InitiatePassPayment {
            initiatePassPayment(
                input: {
                    passId: "${n}"
                    email: "${i}",
                    currency: "${u}",
                    location: "${l}"
                }
            ) {
                orderId
                isInitiated
                amount
            }
        }`})}).then(c=>c.json()).then(c=>{if(c.errors)throw new Error(c.errors[0].message);return m(c.data.initiatePassPayment.amount),c.data.initiatePassPayment.orderId}).catch(c=>{console.log(c)});function Ee(){return new Promise(n=>{const i=document.createElement("script");i.src="https://checkout.razorpay.com/v1/checkout.js",i.onload=()=>{n(!0)},i.onerror=()=>{n(!1)},document.body.appendChild(i)})}function Fe(){const n=document.querySelector('script[src="https://checkout.razorpay.com/v1/checkout.js"]');n&&document.body.removeChild(n)}const $e=(n,i,m,l,u,c,_)=>{async function g(){await Ee()||alert("Razorpay SDK failed to load.Please try again later.");const f={key:"rzp_live_ba3UQjRIBXdeXt",amount:n,currency:"INR",name:"Flickmatch",description:"Flickmatch transaction for football match.",image:"https://firebasestorage.googleapis.com/v0/b/flickmatch-374a2.appspot.com/o/fm_rainbow.png?alt=media&token=1b06ae27-bf10-4974-9100-6bb5f2308314",order_id:i,callback_url:"https://service.flickmatch.in/platform-0.0.1-SNAPSHOT/processPassPayment",redirect:!0,prefill:{name:l,email:m,contact:u},notes:{address:"Tower 8 - Flat 1501, Nirvana Country Rd, The Close South, Sector 50, Gurugram, Haryana 122018"},modal:{ondismiss:function(){_(!1),c(""),Fe(),delete h.Razorpay}},theme:{color:"#4ce95a"}},h=window;new h.Razorpay(f).open()}g()},Be=JSON.stringify({query:`query Passes {
  passes {
  passId
        cityId
        passType
        totalGames
        totalDays
        price
        title
        status
  }
    }`}),C="https://service.flickmatch.in/platform-0.0.1-SNAPSHOT/graphql";function We(){const n=X(),[i,m]=r.exports.useState([]),[l,u]=r.exports.useState({name:"",email:"",phoneNumber:""}),[c,_]=r.exports.useState(!0),[g,S]=r.exports.useState(0),[f,h]=r.exports.useState(""),b=J(e=>e),[k,R]=r.exports.useState([]),[j,O]=r.exports.useState(""),[q,z]=r.exports.useState(""),[v,E]=r.exports.useState(""),[F,T]=r.exports.useState(!1);r.exports.useEffect(()=>{const e=localStorage.getItem("userData");if(e){const t=JSON.parse(e);u({name:t.name,email:t.email,phoneNumber:""})}},[]),r.exports.useEffect(()=>{(async()=>{try{const p=(await(await fetch(C,{method:"POST",headers:{"Content-Type":"application/json"},body:Be})).json()).data.passes;m(p),console.log(p)}catch(t){t instanceof Error&&t.name==="TypeError"&&console.log(t)}})()},[]),r.exports.useEffect(()=>{const e=new AbortController,t=e.signal;return(async()=>{try{const H=await(await fetch(C,{method:"POST",signal:t,headers:{"Content-Type":"application/json"},body:ee})).json();R(H.data.cities)}catch(p){p instanceof Error&&p.name==="TypeError"&&console.log(p.message)}})(),()=>{e.abort()}},[]);const $=e=>{O(e.target.value),te.forEach(t=>{t.cityId===parseInt(e.target.value)&&z(t.currency)})},B=()=>o(x,{children:[s(d,{className:a.fieldTitle,children:"City Name"}),s(U,{className:a.fieldTitleIcon}),s(se,{"aria-labelledby":"demo-radio-buttons-group-label",defaultValue:"female",name:"radio-buttons-group",onChange:$,children:k.map((e,t)=>s(oe,{value:e.cityName,control:s(re,{sx:{"&, &.Mui-checked":{color:"white"}}}),label:e.cityName},t))})]}),A=()=>{c?ze(v,l.email,S,j,q).then(e=>{h(e)}).catch(e=>{console.error(e)}):fetch(C,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`mutation InitiatePassPayment {
            initiatePassPayment(
                input: {
                    passId: "${v}"
                    email: "${l.email}",
                    currency: "INR",
                    location: "Noida"
                }
            ) {
                orderId
                isInitiated
                amount
            }
        }`})}).then(t=>t.json()).then(t=>{if(t.errors)throw new Error(t.errors[0].message)}).catch(t=>{console.log(t)})},w=()=>{T(!1)},M=e=>{T(!0),E(e)};return f&&$e(g,f,l.email,l.name,l.phoneNumber,h,_),o(x,{children:[s(Z,{title:"Game Passes"}),b.login.isAdmin&&b.login.isLoggedIn?o(y,{className:a.pageContainer,children:[s(d,{variant:"h3",className:a.heading,children:"Flickmatch Passes"}),o(y,{className:a.container,children:[i.length>0?i.map((e,t)=>o(y,{className:n?a.portraitPassCard:a.passCard,children:[s("img",{src:pe,alt:"logo",className:a.logo}),s(d,{variant:"h3",className:a.title,children:e.title}),o(d,{className:a.subtitle,children:["Pay for ",e.totalGames-2," games, Play ",e.totalGames," games"]}),o(d,{className:a.price,children:[s(D,{className:a.currency}),e.price]}),s(d,{className:a.status,children:e.status}),o("ul",{className:n?a.portraitDetails:a.details,children:[o("li",{children:[s(N,{className:a.footballIcon}),"Access to all fields"]}),o("li",{children:[s(N,{className:a.footballIcon}),"Join game in single click"]}),o("li",{children:[s(N,{className:a.footballIcon}),"Exclusive member events"]})]}),s(y,{className:a.ribbon,children:o("span",{children:["For ",e.totalDays," Days"]})}),s(P,{className:a.buyNow,onClick:()=>M(e.passId),children:"Buy Now"})]},t)):null,o(Q,{open:F,onClose:w,className:a.diaglogBox,children:[s(W,{children:"Please select your city"}),s(Y,{style:{width:350},children:B()}),o(ae,{children:[s(P,{className:a.cancel,onClick:w,children:"Cancel"}),s(P,{className:a.pay,onClick:A,children:"Pay"})]})]})]})]}):null]})}export{We as default};
