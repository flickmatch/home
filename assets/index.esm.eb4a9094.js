import{a as e,j as L}from"./index.863ef66a.js";function A(o={}){const{nonce:t,onScriptLoadSuccess:r,onScriptLoadError:l}=o,[v,s]=e.exports.useState(!1),u=e.exports.useRef(r);u.current=r;const p=e.exports.useRef(l);return p.current=l,e.exports.useEffect(()=>{const n=document.createElement("script");return n.src="https://accounts.google.com/gsi/client",n.async=!0,n.defer=!0,n.nonce=t,n.onload=()=>{var c;s(!0),(c=u.current)===null||c===void 0||c.call(u)},n.onerror=()=>{var c;s(!1),(c=p.current)===null||c===void 0||c.call(p)},document.body.appendChild(n),()=>{document.body.removeChild(n)}},[t]),v}const S=e.exports.createContext(null);function k({clientId:o,nonce:t,onScriptLoadSuccess:r,onScriptLoadError:l,children:v}){const s=A({nonce:t,onScriptLoadSuccess:r,onScriptLoadError:l}),u=e.exports.useMemo(()=>({clientId:o,scriptLoadedSuccessfully:s}),[o,s]);return L(S.Provider,{value:u,children:v})}function G(){const o=e.exports.useContext(S);if(!o)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return o}function E(){var o,t,r;(r=(t=(o=window==null?void 0:window.google)===null||o===void 0?void 0:o.accounts)===null||t===void 0?void 0:t.id)===null||r===void 0||r.disableAutoSelect()}function O({flow:o="implicit",scope:t="",onSuccess:r,onError:l,onNonOAuthError:v,overrideScope:s,state:u,...p}){const{clientId:n,scriptLoadedSuccessfully:c}=G(),g=e.exports.useRef(),x=e.exports.useRef(r);x.current=r;const m=e.exports.useRef(l);m.current=l;const w=e.exports.useRef(v);w.current=v,e.exports.useEffect(()=>{var i,d;if(!c)return;const R=o==="implicit"?"initTokenClient":"initCodeClient",b=(d=(i=window==null?void 0:window.google)===null||i===void 0?void 0:i.accounts)===null||d===void 0?void 0:d.oauth2[R]({client_id:n,scope:s?t:`openid profile email ${t}`,callback:f=>{var a,h;if(f.error)return(a=m.current)===null||a===void 0?void 0:a.call(m,f);(h=x.current)===null||h===void 0||h.call(x,f)},error_callback:f=>{var a;(a=w.current)===null||a===void 0||a.call(w,f)},state:u,...p});g.current=b},[n,c,o,t,u]);const _=e.exports.useCallback(i=>{var d;return(d=g.current)===null||d===void 0?void 0:d.requestAccessToken(i)},[]),C=e.exports.useCallback(()=>{var i;return(i=g.current)===null||i===void 0?void 0:i.requestCode()},[]);return o==="implicit"?_:C}export{k as G,E as g,O as u};
