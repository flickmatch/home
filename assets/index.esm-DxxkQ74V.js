import{r as e,I as A}from"./loginSlice-CZoiq6UI.js";function E(o={}){const{nonce:t,onScriptLoadSuccess:n,onScriptLoadError:l}=o,[v,s]=e.useState(!1),u=e.useRef(n);u.current=n;const f=e.useRef(l);return f.current=l,e.useEffect(()=>{const c=document.createElement("script");return c.src="https://accounts.google.com/gsi/client",c.async=!0,c.defer=!0,c.nonce=t,c.onload=()=>{var r;s(!0),(r=u.current)===null||r===void 0||r.call(u)},c.onerror=()=>{var r;s(!1),(r=f.current)===null||r===void 0||r.call(f)},document.body.appendChild(c),()=>{document.body.removeChild(c)}},[t]),v}const h=e.createContext(null);function y({clientId:o,nonce:t,onScriptLoadSuccess:n,onScriptLoadError:l,children:v}){const s=E({nonce:t,onScriptLoadSuccess:n,onScriptLoadError:l}),u=e.useMemo(()=>({clientId:o,scriptLoadedSuccessfully:s}),[o,s]);return A.createElement(h.Provider,{value:u},v)}function G(){const o=e.useContext(h);if(!o)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return o}function k(){var o,t,n;(n=(t=(o=window==null?void 0:window.google)===null||o===void 0?void 0:o.accounts)===null||t===void 0?void 0:t.id)===null||n===void 0||n.disableAutoSelect()}function O({flow:o="implicit",scope:t="",onSuccess:n,onError:l,onNonOAuthError:v,overrideScope:s,state:u,...f}){const{clientId:c,scriptLoadedSuccessfully:r}=G(),p=e.useRef(),m=e.useRef(n);m.current=n;const w=e.useRef(l);w.current=l;const S=e.useRef(v);S.current=v,e.useEffect(()=>{var i,d;if(!r)return;const b=o==="implicit"?"initTokenClient":"initCodeClient",L=(d=(i=window==null?void 0:window.google)===null||i===void 0?void 0:i.accounts)===null||d===void 0?void 0:d.oauth2[b]({client_id:c,scope:s?t:`openid profile email ${t}`,callback:g=>{var a,_;if(g.error)return(a=w.current)===null||a===void 0?void 0:a.call(w,g);(_=m.current)===null||_===void 0||_.call(m,g)},error_callback:g=>{var a;(a=S.current)===null||a===void 0||a.call(S,g)},state:u,...f});p.current=L},[c,r,o,t,u]);const R=e.useCallback(i=>{var d;return(d=p.current)===null||d===void 0?void 0:d.requestAccessToken(i)},[]),C=e.useCallback(()=>{var i;return(i=p.current)===null||i===void 0?void 0:i.requestCode()},[]);return o==="implicit"?R:C}export{y as G,k as g,O as u};
