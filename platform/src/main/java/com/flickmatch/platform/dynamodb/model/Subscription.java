package com.flickmatch.platform.dynamodb.model;

import com.amazonaws.services.dynamodbv2.datamodeling.*;
import lombok.*;
import org.springframework.data.annotation.Id;


@DynamoDBTable(tableName="Subscription")
@Builder
@AllArgsConstructor
@NoArgsConstructor
public class Subscription {

    @DynamoDBHashKey(attributeName="userId")
    public String getUserId() {
        return this.subscriptionKey != null ? this.subscriptionKey.getUserId() : null;
    }

    public void setUserId(String userId) {
        if (this.subscriptionKey == null) {
            this.subscriptionKey = new SubscriptionKey();
        }
        this.subscriptionKey.setUserId(userId);
    }

    @DynamoDBRangeKey(attributeName = "subscriptionId")
    @DynamoDBAutoGeneratedKey
    public String getSubscriptionId() {
        return this.subscriptionKey != null ? this.subscriptionKey.getSubscriptionId() : null;
    }

    public void setSubscriptionId(String subscriptionId) {
        if (this.subscriptionKey == null) {
            this.subscriptionKey = new SubscriptionKey();
        }
        this.subscriptionKey.setSubscriptionId(subscriptionId);
    }

    private String status;

    private String passId;

    private Double creditsLeft;

    private String expiryDate;
    private String cityId;
    private String title;
    private String description;

    public String getTitle() {
        return title;
    }

    public void setTitle(String title) {
        this.title = title;
    }
    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    public String getStatus() {
        return status;
    }

    public void setStatus(String status) {
        this.status = status;
    }

    public String getPassId() {
        return passId;
    }

    public void setPassId(String passId) {
        this.passId = passId;
    }

    public Double getCreditsLeft() {
        return creditsLeft;
    }

    public void setCreditsLeft(Double creditsLeft) {
        this.creditsLeft = creditsLeft;
    }

    public String getExpiryDate() {
        return expiryDate;
    }

    public void setExpiryDate(String expiryDate) {
        this.expiryDate = expiryDate;
    }

    public String getCityId() {
        return cityId;
    }

    public void setCityId(String cityId) {
        this.cityId = cityId;
    }

    // This is a composite key made up of userId and subscriptionId
    @Id
    private SubscriptionKey subscriptionKey;

    @Builder
    public static class SubscriptionKey {

        private String userId;

        private String subscriptionId;

        SubscriptionKey() {
        }

        SubscriptionKey(String userId, String subscriptionId) {
            this.userId = userId;
            this.subscriptionId = subscriptionId;
        }

        @DynamoDBHashKey(attributeName="userId")
        public String getUserId() {
            return userId;
        }

        public void setUserId(String userId) {
            this.userId = userId;
        }

        @DynamoDBRangeKey(attributeName="subscriptionId")
        @DynamoDBAutoGeneratedKey
        public String getSubscriptionId() {
            return subscriptionId;
        }

        public void setSubscriptionId(String subscriptionId) {
            this.subscriptionId = subscriptionId;
        }
    }

}
